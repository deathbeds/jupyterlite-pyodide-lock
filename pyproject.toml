# repo-level configuration for `jupyterlite-pyodide-lock*`
[tool.mypy]
cache_dir = "build/.cache/mypy"
python_version = "3.10"
strict = true
show_error_codes = true
warn_return_any = true
warn_unused_ignores = true

[[tool.mypy.overrides]]
ignore_missing_imports = true
module = ["ipywidgets", "jsonpointer"]

[tool.pylsp-mypy]
enabled = true
dmypy = true
live_mode = false

[tool.ruff]
preview = true
target-version = "py310"
line-length = 88
extend-include = ["*.ipynb"]
include = ["_scripts/*.py", "py/**/*.py", "docs/**/*.py", "examples/**/*.ipynb"]
cache-dir = "build/.cache/ruff"

[tool.ruff.lint]
select = ["ALL"]
flake8-copyright.notice-rgx = '''
# Copyright \(c\) jupyterlite-pyodide-lock contributors\.
# Distributed under the terms of the BSD-3-Clause License\.
'''
isort.known-first-party = [
  "jupyterlite_pyodide_lock",
  "jupyterlite_pyodide_lock_webdriver",
]

ignore = [
  "ANN401",
  "C408",
  "COM812",
  "D203",
  "D211",
  "D213",
  "DOC201",
  "DOC402",
  "DOC501",
  "ISC001",
  "PERF203",
  "PGH003",
  "PLC0415",
  "PLR6301",
  "RUF015",
]

[tool.ruff.lint.per-file-ignores]
"_scripts/*.*" = [
  "INP001",
  "T201",
  "SLF001",
  "FBT001",
  "PLC1901",
]
"docs/conf.py" = [
  "INP001",
  "A001",
  "E731",
  "S404",
]
"**/*.ipynb" = [
  "CPY001",
  "T201",
  "TRY004",
]
"examples/*.ipynb" = [
  "T201",
]
"*/jupyterlite_pyodide_lock_webdriver/locker.py" = [
  "BLE001",
]
"*/lock.py" = [
  "ARG002",
  "T201",
  "BLE001",
]
"*/lockers/__init__.py" = [
  "ARG001",
]
"*/browser.py" = [
  "S603",
  "S404",
]
"*/logger.py" = [
  "BLE001",
]
"*/solver.py" = [
  "ARG002",
]
"*/tornado.py" = [
  "BLE001",
]
"utils.py" = [
  "C901",
]
"**/tests/**/*.py" = [
  "PLC0415",
  "S101",
  "S603",
  "S607",
  "S404",
  "T201",
]

# sphinx #######################################################################
[tool.sphinx-j2.context]
ppt = "py/jupyterlite-pyodide-lock/pyproject.toml"

[tool.sphinx-j2.intersphinx]
python = "https://docs.python.org/3"
jupyterlite_core = "https://jupyterlite.readthedocs.io/en/stable"
traitlets = "https://traitlets.readthedocs.io/en/stable"
jupyterlite_pyodide_kernel = "https://jupyterlite-pyodide-kernel.readthedocs.io/en/stable"

[tool.sphinx-j2.template]
author = "{{ ppt.project.authors[0].name }}"
project = "{{ ppt.project.name }}"
copyright = "2024, {{ ppt.project.authors[0].name }}"
release = "{{ ppt.project.version }}"
version = "{{ ppt.project.version }}"
extensions = [
  "sphinx.ext.autodoc",
  "sphinx_autodoc_typehints",
  "sphinx.ext.intersphinx",
  "sphinx.ext.viewcode",
  "myst_nb",
  "sphinx.ext.autosectionlabel",
  "sphinx_copybutton",
  "autodoc_traits",
]
suppress_warnings = ["autosectionlabel.*", "myst.xref_missing"]
exclude_patterns = ["rtd.rst"]
language = "en"

## autodoc
autoclass_content = "both"
always_document_param_types = true
typehints_defaults = "comma"
typehints_use_signature_return = true
autodoc_default_options = {members = true, show-inheritance = true, undoc-members = true}
autosectionlabel_prefix_document = true

## myst
myst_heading_anchors = 3

## theme
html_theme = "pydata_sphinx_theme"
html_static_path = ["_static", "../dist", "../build/docs-app"]
html_css_files = ["theme.css"]

[tool.sphinx.html_sidebars]
demo = []

[tool.sphinx.html_theme_options]
logo = {text = "{{ ppt.project.name }}"}
github_url = "{{ ppt.project.urls.Source }}"
icon_links = [
  {name = "PyPI", url = "{{ ppt.project.urls.PyPI }}", icon = "fa-brands fa-python", type = "fontawesome"},
]
pygments_dark_style = "github-dark-colorblind"
pygments_light_style = "github-light-colorblind"
navigation_with_keys = false
